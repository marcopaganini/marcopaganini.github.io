<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Git Tips | paganini.net</title>
<meta name="keywords" content="coding, git">
<meta name="description" content="A collection of useful git tips for all levels of experience.
">
<meta name="author" content="Marco Paganini">
<link rel="canonical" href="https://www.paganini.net/posts/git/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.360611f796b9d00da9c84e601147db753a59975e0be3d8e55a1da51afa6574ce.css" integrity="sha256-NgYR95a50A2pyE5gEUfbdTpZl14L49jlWh2lGvpldM4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.paganini.net/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.paganini.net/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.paganini.net/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.paganini.net/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.paganini.net/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.paganini.net/posts/git/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:title" content="Git Tips" />
<meta property="og:description" content="A collection of useful git tips for all levels of experience.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.paganini.net/posts/git/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-28T00:00:00+00:00" /><meta property="og:site_name" content="Welcome to paganini.net" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Git Tips"/>
<meta name="twitter:description" content="A collection of useful git tips for all levels of experience.
"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.paganini.net/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Git Tips",
      "item": "https://www.paganini.net/posts/git/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Git Tips",
  "name": "Git Tips",
  "description": "A collection of useful git tips for all levels of experience.\n",
  "keywords": [
    "coding", "git"
  ],
  "articleBody": "Git tips Disclaimer Most of these notes were taken late at night and in a hurry, so errors may exist. As usual, git status is your friend and will show you the status of your repository and common commands you may need to use.\nSetup Before anything else, make sure to setup your email and name. This will appear on every commit:\ngit config --global user.name \"Firstname Lastname\" git config --global user.email \"youremail@domain.com\" If using on a directory where we don’t want to see every file not under git control when running git status:\ngit config [--global] status.showUntrackedFiles no Create a handy dandy “git graph” command (git g):\ngit config --global --add alias.g \"log --graph --abbrev-commit --decorate --format=format:'%C(bold blue)%h%C(reset) % C(auto)%d%C(reset) %s %C(dim white)- %an (%ar)' --all\" Creating a new repo Create a .git directory in the current repository: git init [directory] Create a bare repository in a file, suitable for external use. By convention, bare directories always end up in .git. Bare repositories don’t have a working directory, so it’s impossible to commit changes to them. All central repositories should be created with the --bare command line option. More detailed explanation: https://mijingo.com/blog/what-is-a-bare-git-repository git init --bare Branching \u0026 Merging Switch to branch branch: git checkout Create a branch named branch, optionally at [commit_number]: git checkout -b [commit_number] Create a branch named branch tracking remote branch: git checkout -b E.g.: git checkout -b foo origin devel List branches: git branch List all branches (including remote): git branch -a List remote branches: git branch -r Remove remote tracking branch: git branch -r -d Delete branch remote/branch: git push --delete E.g.: git push origin --delete foobar List details about branches: git branch -v Remove branch locally: git branch -d Remove remote branch: git push --delete Create a local branch branch pointing to the current HEAD, but don’t switch to it.: git branch Create a local branch branch pointing to origin/dev: git branch --track origin/dev The the tracking branch of branch to origin/foo. Set tracking repo of current branch if [branch] is ommitted.: git branch --set-upstream-to=origin/foo [branch] Merge change: git merge git mergetool: https://gist.github.com/karenyyng/f19ff75c60f18b4b8149 Checking out a remote repo into a local branch (Patching a PR, manual merge) Create a new branch and pull the remote repo into it.\ngit checkout -b master git pull https://github.com// Merge the changes:\ngit checkout master git merge --no-ff # Use --ff-only or rebase if preferred. git push origin master Pushing Changes Push current branch to remote branch origin/branchname (creates remote branch if necessary).: git push origin branchname Promote current development branch to master on origin.: git push origin origin/development:master Diffs, logs \u0026 status Perform manual changes after a git merge, if needed.: git mergetool -t vimdiff Simple one line format log: git log --oneline Diff the current HEAD with the previous version: git diff HEAD^ HEAD Diff a given remote/branch with HEAD.: git diff / HEAD Diff index with HEAD.: git diff --cached See all delete operations affecting “filename”: git log --diff-filter=D -- filename To restore the file: git checkout -r ~1 -- filename\" Tagging Show all tags (same as git tag -l): git tag Create a lightweight tag named foo: git tag foo Create a regular tag named foo, with the specified message.: git tag -a foo -m \"This is the tag foo\" Create a tag named foo, at commit 9fceb02: git tag -a foo 9fceb02 Push tag foobar to origin.: git push origin foobar Push all tags to origin: git push origin --tags Checks out the repo at the tag version (will create a detached head, create a new branch from this head to work on this tag.): git checkout supertag_foo Delete local tag: git tag -d tagname Delete remote tag: git push --delete origin tagname Push a single tag: git push origin :refs/tags/ Attach a tag to a commit id: git tag Delete local and remote tag, retag a given tag at a commit id.: git push origin Important Note: Tags won’t be pushed without the explicit tag name or the –tags flag.\nSubmodules Add a submodule to the system (file .gitmodules created): git submodule add Initialize submodules – copies submodule name and urls from .gitmodules to .git/config.: git submodule init Clone a module with submodules: git clone --recursive Recursively update submodules. Specify --init to init and update in one step.: git submodule update --recursive [--init] Update the submodule itself to the newest commit from the submodule’s upstream. Using git status on the project directory after that will show “modified: subproject_name (new commits)”. A regular git add/commit should follow.: cd submodule_dir; git pull; cd project_dir Revert submodule state to the submitted one.: git submodule update --init Remove a submodule: git submodule deinit git rm git commit -m \"Removed submodule.\" rm -rf .git/modules/ Commiting, resetting \u0026 rebasing Commit staged files.: git commit Commit all changed files.: git commit -a Verbose. Show a diff during commit message edit.: git commit -v Fix the last commit message.: git commit --amend Squashes the last four commits into one, interactively. After this command, use git push –force if one of the rebased changes was already pushed. An interactive editor will open to decide what to do with each commit. Changing pick to squash means this commit will be merged with the commit above it (note that git lists the commit in chronological order, so the earlier commits are at the top of the list.): git rebase -i HEAD~4 Note: The number after head (n) means N commits will be affected. Just removing the commit from the list of commits later means it will be discarded! It’s also possible to give a commit#. In this case, all commits from that point will be included.\nUse “drop” to drop an unwanted commit. Use the “–onto branch” keyword to do all the interactive rebase changes and then rebase on top of another commit in one operation.\nE.g.: Remove one of he commits and rebase on top of upstream/master\n# Mark the commit to be removed as \"drop\" git rebase -i HEAD~4 --onto upstream/master Resets the repo to commit#: git reset --hard Undo the last commit. Leave changes as changed files, ready for editing and a new commit.: git reset HEAD~ Same as above, but leaves files staged.: git reset --soft HEAD~ Reset a particular file to HEAD. Useful to remove files from the staged area or when unwinding files from a previous git reset –soft (removing unwanted changes.): git reset HEAD /path/to/unwanted/file Miscellaneous Show all remotes: git remote -v Show one particular remote. E.g.: git remote show origin: git remote show Set remote URL (use –push for push URL) to a given url.: git remote set-url [--push] E.g.: git remote set-url --push origin git@github.com:foouser/reponame.git Show all files in repo: git ls-files Show reflog (updates to the tip of branches) information. It’s possible to undo steps by using “git reset” on one of the HEADs presented.: git reflog Cherry Picking: git show remote --oneline aaaaaa foo change HEAD bbbbbb bar change cccccc meh change We want to remove bbbbbb:\ngit reset cccccc --hard git cherrypick -n aaaaaa git status Commit and push as usual.\nFully encrypted repos using git-remote-gcrypt. Reference: https://embeddedartistry.com/blog/2018/03/15/safely-storing-secrets-in-git/\nInstall git-remote-gcrypt with apt-get install git-remote-gcrypt. Important: Must have GPG_TTY set correctly with export GPG_TTY=$(tty), or pinentry will barf. Sample usage: git remote add origin gcrypt::git@github.com:user/reponame.git git push origin master Important: EVERY PUSH has --force implied! Make sure to use git pull first!!!\nNote on:\ngcrypt: Repository not found: git@bitbucket.org:mpaganini/crypto-edgerouter.git gcrypt: ..but repository ID is set. Aborting. This happens when the initial repo push fails. We end up with a push ID but the repo does not have it. In this case, just remove the gcrypt-id of this repo with:\ngit config --unset remote.origin.gcrypt-id Real life example for /etc:\n# git remote -v origin gcrypt::git@github.com:marcopaganini/crypto.git (fetch) origin gcrypt::git@github.com:marcopaganini/crypto.git (push) Partially (or fully) encrypted repos using git-crypt Creating a new repo Reference: man git-crypt.\nWith this solution, we can have some (or all) files encrypted in the repo. It has the advantage of not requiring a “–force” when pushing and accounting for times correctly. The downside is that the names of the files remain visible.\napt-get install git-crypt In the repo, git-crypt init Add the user with git-crypt add-gpg-user gpg_key_id. This will create the .git-crypt directory with the keys. Create a .gitattributes file indicating which files will be encrypted. E.g: file_to_encrypt filter=git-crypt diff=git-crypt *.key filter=git-crypt diff=git-crypt To encrypt all files (except .gitattributes, naturally):\n* filter=git-crypt diff=git-crypt .gitattributes !filter !diff Add and commit this file.\nRun a git-crypt status and make sure that the required files are encrypted correctly.'\nFrom this point on, git push will store the files encrypted on the remote.\nWhen using a cloned repo, it’s important to use git-crypt unlock first.\nIMPORTANT: Files added before git-crypt init remain unencrypted. git-crypt status --fix can fix the current commit, but not the history.\nUsing an existing repo Sample commands:\ngit@github.com:marcopaganini/crypto.git cd cryptorepo git-crypt unlock Using git-LFS Installation is simple:\napt-get install git-lfs git lfs install --local --skip-smudge Note: to initialize a repo, always use git lfs install --local --skip-smudge. Using the smudge filter will make everything slower, but without it, a manual git lfs-pull is required every time we want to update the git-lfs files.\nTo add files to be tracked: git lfs track glob (E.g.: git lfs track *.ttf) git lfs pull will bring the files. To Uninstall:\nRemove the files from git-lfs control with git lfs untrack glob. This will remove the .gitattributes file from the directory where they live. Commit the changes. Remove the previously tracked files (with rm, not git rm). Run git checkout .. This will bring the original pointer files. It’s also possible to delete the files with git rm or git rm --cached (if we want to keep the files.) Use git rm to remove the pointer files. Run git lfs uninstall --worktree to remove git-lfs from the local repository config. Note: git-lfs ls-files will show all LFS “controlled” files until the repo is re-created.\nSimple github workflow git clone git@github.com/marcopaganini/repo \u003c-- checks out the forked repo cd repo git branch -vv (shows the branches) git checkout -b dev (creates a branch dev, without tracking) Before every change:\nUpdate all remotes: git remote update Create a working repo: git checkout -b dev Reset the working repo to upstream: git reset upstream/master --hard Also possible to pull/rebase directly from dev: git pull -r upstream master Do the changes, git add, git commit. When ready to submit: git pull -r upstream master (making sure we’re on top of head). git push origin dev Go to https://github.com and open a PR (or use gh pr create) In case of changes:\nRepeat edits, commit, push git pull -r upstream master git push origin dev --force (–force may be needed or not, depending on the situation). It is also possible to use a regular commit instead of rebase, and rebase on github at merge time. This makes it somewhat easier to have simultaneous development branches, but creates a non-linear history on the repo.\nTip: Storing images in github The idea is to create a new branch with no commits (–orphan) and store the images here. They can be referenced directly from markdown on the main branch. In a nutshell:\ngit checkout --orphan assets # Start a new branch from nothing. git rm -rf . # Remove everything from this branch. git add; git commit git push origin assets git checkout master To refer to this file, use (in the master branch): ![Image](../assets/file.png?raw=true)\nSource: https://gist.github.com/joncardasis/e6494afd538a400722545163eb2e1fa5 Daisy Chained changes using github Taken from: https://graysonkoonce.com/stacked-pull-requests-keeping-github-diffs-small/\nThe idea is to have multiple pending PRs, one depending on the previous one, with only the diffs to the previous one. This only works if using branches on the same repository where the final changes are to be merged. Basic idea:\nCreate a branch named foo-part1 with the first part of our changes. git checkout -b foo-part1 git commit -am 'Changes, part 1' git push origin foo-part1 hub pull-request # This will create a PR from foo-part1 -\u003e master Create a second branch names foo-part1 with the second part of changes. git checkout -b foo-part2 git commit -am 'Changes, part 2' git push origin foo-part2 hub pull-request -b foo-part1 # Notice how the base is the previous branch! Repeat this as many times as needed.\nIf a change is required in one of the PRs, don’t forget to merge (not rebase) the change to the upper ones. E.g.: Change on part2 must be merged in part3:\ngit checkout foo-part2 git merge foo-part2 git commit... git push origin-part2 Once the PRs have been approved, squash/merge them from the top down. The first one can be rebased into master.\nsquash/merge foo-part2 into foo-part1 squash/rebase foo-part1 into master Remove the branches to keep the repo clean, if that’s desirable. Interesting discussion on git merge \u0026 git rebase http://stackoverflow.com/questions/6406762/why-am-i-merging-remote-tracking-branch-origin-develop-into-develop\nAnd…\nhttps://www.derekgourlay.com/blog/git-when-to-merge-vs-when-to-rebase/\nWorkflow from repo creation to use: $ git init --bare /tmp/foo.git Initialized empty Git repository in /tmp/foo.git/ $ mkdir /tmp/client $ cd /tmp/client $ git clone ssh://:/tmp/foo.git . Cloning into '.'... warning: You appear to have cloned an empty repository. Checking connectivity... done. $ git remote show origin * remote origin Fetch URL: ssh://localhost:/tmp/foo.git Push URL: ssh://localhost:/tmp/foo.git HEAD branch: (unknown) Local branch configured for 'git pull': master merges with remote master $ echo haha \u003eREADME $ git add README $ git status On branch master Initial commit Changes to be committed: (use \"git rm --cached ...\" to unstage) new file: README Untracked files not listed (use -u option to show untracked files) $ git commit -m \"Initial import.\" [master (root-commit) 18fb1b9] Initial import. 1 file changed, 1 insertion(+) create mode 100644 README $ git push origin master Counting objects: 3, done. Writing objects: 100% (3/3), 217 bytes | 0 bytes/s, done. Total 3 (delta 0), reused 0 (delta 0) To ssh://localhost:/tmp/foo.git * [new branch] master -\u003e master $ git branch -a * master remotes/origin/master Changing author info on an existing repo https://help.github.com/articles/changing-author-info/\nRemoving all history for deleted files This answer seems to be the best:\nhttp://stackoverflow.com/questions/17901588/new-repo-with-copied-history-of-only-currently-tracked-files/17909526#17909526 Delete everything and restore what you want Rather than delete this-list-of-files one at a time, do the almost-opposite, delete everything and just restore the files you want to keep:\ngit checkout master git ls-files \u003e keep-these.txt git filter-branch --force --index-filter \\ \"git rm --ignore-unmatch --cached -qr . ; cat $PWD/keep-these.txt | xargs git reset -q \\$GIT_COMMIT --\" \\ --prune-empty --tag-name-filter cat -- --all Cleanup steps Once the whole process has finished, then cleanup:\nrm -rf .git/refs/original/ git reflog expire --expire=now --all git gc --prune=now # optional extra gc. Slow and may not further-reduce the repo size git gc --aggressive --prune=now Removing a large file from the repository http://goo.gl/J9aOP\nComparing the repository size before and after, should indicate a sizable reduction, and of course only commits that touch the kept files, plus merge commits - even if empty (because that’s how –prune-empty works), will be in the history.\nCopying one directory to another repo, keeping history:\ngit clone foo cd foo git filter-branch --subdirectory-filter directory_to_keep -- --all git remote -v # (confirm old origin, then...) git remote set-url origin git remote -v # (make sure all is fine, then...) git push origin Another solution from: http://goo.gl/VsMAc\nMake a copy of repository A so you can mess with it without worrying about mistakes too much. It’s also a good idea to delete the link to the original repository to avoid accidentally making any remote changes (line 3). Line 4 is the critical step here. It goes through your history and files, removing anything that is not in directory 1. The result is the contents of directory 1 spewed out into to the base of repository A. You probably want to import these files into repository B within a directory, so move them into one now (lines 5/6). Commit your changes and we’re ready to merge these files into the new repository.\ngit clone cd git remote rm origin git filter-branch --subdirectory-filter -- --all mkdir mv * git add . git commit Make a copy of repository B if you don’t have one already. On line 3, you’ll create a remote connection to repository A as a branch in repository B. Then simply pull from this branch (containing only the directory you want to move) into repository B. The pull copies both files and history. Note: You can use a merge instead of a pull, but pull worked better for me. Finally, you probably want to clean up a bit by removing the remote connection to repository A. Commit and you’re all set.\ngit clone cd git remote add repo-A-branch git pull repo-A-branch master git remote rm repo-A-branch Cleaning up/splitting repo THE SOLUTION WHAT WORKED:\nGet BFG @ http://rtyley.github.io/bfg-repo-cleaner/\nMany options, but I stripped by directory:\ngit clone --mirror ssh://triton:/data/git/all.git . java -jar bfg.jar --delete-folders mods . git reflog expire --expire=now --all git gc --prune=now --aggressive Comparing the results:\nOn each directory, generate a list of revs:\ngit rev-list --objects --all | awk '(NF \u003e 1) { print $2 }' | sort -u \u003efileX Then diff files.\nRepo size in KB git count-objects -v | grep size-pack Links \u0026 Useful sites Git maintenance \u0026 data recovery: http://git-scm.com/book/en/Git-Internals-Maintenance-and-Data-Recovery Git for SVN users: http://git.or.cz/course/svn.html https://learngitbranching.js.org/ “the most visual and interactive way to learn Git on the web; you’ll be challenged with exciting levels, given step-by-step demonstrations of powerful features, and maybe even have a bit of fun along the way.” https://kbroman.org/github_tutorial/ “git/github guide a minimal tutorial” http://think-like-a-git.net/ “My goal with this site is to help you, Dear Reader, understand what those smug bastards [git knowers] are talking about.” Looks especially useful: http://think-like-a-git.net/halp.html, “If you’ve just lost some work in Git, and you’re trying to recover your lost commits, this page is for you.” ",
  "wordCount" : "3016",
  "inLanguage": "en",
  "datePublished": "2024-06-28T00:00:00Z",
  "dateModified": "2024-06-28T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Marco Paganini"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.paganini.net/posts/git/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "paganini.net",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.paganini.net/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.paganini.net/" accesskey="h" title="paganini.net (Alt + H)">paganini.net</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.paganini.net/posts/resume" title="📄 Resume">
                    <span>📄 Resume</span>
                </a>
            </li>
            <li>
                <a href="https://www.paganini.net/posts/photos" title="📷 Photos">
                    <span>📷 Photos</span>
                </a>
            </li>
            <li>
                <a href="https://www.paganini.net/archives" title="🗃️ Archive">
                    <span>🗃️ Archive</span>
                </a>
            </li>
            <li>
                <a href="https://www.paganini.net/tags/" title="🏷️ Tags">
                    <span>🏷️ Tags</span>
                </a>
            </li>
            <li>
                <a href="https://www.paganini.net/search/" title="🔍 Search">
                    <span>🔍 Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.paganini.net/">Home</a>&nbsp;»&nbsp;<a href="https://www.paganini.net/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Git Tips
    </h1>
    <div class="post-description">
      A collection of useful git tips for all levels of experience.

    </div>
    <div class="post-meta"><span title='2024-06-28 00:00:00 +0000 UTC'>June 28, 2024</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;Marco Paganini

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#git-tips" aria-label="Git tips">Git tips</a><ul>
                        
                <li>
                    <a href="#disclaimer" aria-label="Disclaimer">Disclaimer</a></li>
                <li>
                    <a href="#setup" aria-label="Setup">Setup</a></li>
                <li>
                    <a href="#creating-a-new-repo" aria-label="Creating a new repo">Creating a new repo</a></li>
                <li>
                    <a href="#branching--merging" aria-label="Branching &amp; Merging">Branching &amp; Merging</a><ul>
                        
                <li>
                    <a href="#checking-out-a-remote-repo-into-a-local-branch-patching-a-pr-manual-merge" aria-label="Checking out a remote repo into a local branch (Patching a PR, manual merge)">Checking out a remote repo into a local branch (Patching a PR, manual merge)</a></li></ul>
                </li>
                <li>
                    <a href="#pushing-changes" aria-label="Pushing Changes">Pushing Changes</a></li>
                <li>
                    <a href="#diffs-logs--status" aria-label="Diffs, logs &amp; status">Diffs, logs &amp; status</a></li>
                <li>
                    <a href="#tagging" aria-label="Tagging">Tagging</a></li>
                <li>
                    <a href="#submodules" aria-label="Submodules">Submodules</a></li>
                <li>
                    <a href="#commiting-resetting--rebasing" aria-label="Commiting, resetting &amp; rebasing">Commiting, resetting &amp; rebasing</a></li>
                <li>
                    <a href="#miscellaneous" aria-label="Miscellaneous">Miscellaneous</a></li>
                <li>
                    <a href="#fully-encrypted-repos-using-git-remote-gcrypt" aria-label="Fully encrypted repos using git-remote-gcrypt.">Fully encrypted repos using git-remote-gcrypt.</a></li>
                <li>
                    <a href="#partially-or-fully-encrypted-repos-using-git-crypt" aria-label="Partially (or fully) encrypted repos using git-crypt">Partially (or fully) encrypted repos using git-crypt</a><ul>
                        
                <li>
                    <a href="#creating-a-new-repo-1" aria-label="Creating a new repo">Creating a new repo</a></li>
                <li>
                    <a href="#using-an-existing-repo" aria-label="Using an existing repo">Using an existing repo</a></li></ul>
                </li>
                <li>
                    <a href="#using-git-lfs" aria-label="Using git-LFS">Using git-LFS</a></li>
                <li>
                    <a href="#simple-github-workflow" aria-label="Simple github workflow">Simple github workflow</a></li>
                <li>
                    <a href="#tip-storing-images-in-github" aria-label="Tip: Storing images in github">Tip: Storing images in github</a></li>
                <li>
                    <a href="#daisy-chained-changes-using-github" aria-label="Daisy Chained changes using github">Daisy Chained changes using github</a><ul>
                        
                <li>
                    <a href="#create-a-branch-named-foo-part1-with-the-first-part-of-our-changes" aria-label="Create a branch named foo-part1 with the first part of our changes.">Create a branch named foo-part1 with the first part of our changes.</a></li>
                <li>
                    <a href="#create-a-second-branch-names-foo-part1-with-the-second-part-of-changes" aria-label="Create a second branch names foo-part1 with the second part of changes.">Create a second branch names foo-part1 with the second part of changes.</a></li></ul>
                </li>
                <li>
                    <a href="#workflow-from-repo-creation-to-use" aria-label="Workflow from repo creation to use:">Workflow from repo creation to use:</a></li>
                <li>
                    <a href="#changing-author-info-on-an-existing-repo" aria-label="Changing author info on an existing repo">Changing author info on an existing repo</a></li>
                <li>
                    <a href="#removing-all-history-for-deleted-files" aria-label="Removing all history for deleted files">Removing all history for deleted files</a></li>
                <li>
                    <a href="#delete-everything-and-restore-what-you-want" aria-label="Delete everything and restore what you want">Delete everything and restore what you want</a><ul>
                        
                <li>
                    <a href="#cleanup-steps" aria-label="Cleanup steps">Cleanup steps</a></li></ul>
                </li>
                <li>
                    <a href="#removing-a-large-file-from-the-repository" aria-label="Removing a large file from the repository">Removing a large file from the repository</a></li>
                <li>
                    <a href="#cleaning-upsplitting-repo" aria-label="Cleaning up/splitting repo">Cleaning up/splitting repo</a></li>
                <li>
                    <a href="#repo-size-in-kb" aria-label="Repo size in KB">Repo size in KB</a></li>
                <li>
                    <a href="#links--useful-sites" aria-label="Links &amp; Useful sites">Links &amp; Useful sites</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="git-tips">Git tips<a hidden class="anchor" aria-hidden="true" href="#git-tips">#</a></h1>
<h2 id="disclaimer">Disclaimer<a hidden class="anchor" aria-hidden="true" href="#disclaimer">#</a></h2>
<p>Most of these notes were taken late at night and in a hurry, so errors may exist.
As usual, <code>git status</code> is your friend and will show you the status of your repository
and common commands you may need to use.</p>
<h2 id="setup">Setup<a hidden class="anchor" aria-hidden="true" href="#setup">#</a></h2>
<p>Before <em>anything</em> else, make sure to setup your email and name. This will
appear on every commit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config --global user.name <span style="color:#e6db74">&#34;Firstname Lastname&#34;</span>
</span></span><span style="display:flex;"><span>git config --global user.email <span style="color:#e6db74">&#34;youremail@domain.com&#34;</span>
</span></span></code></pre></div><p>If using on a directory where we don&rsquo;t want to see every file not under git
control when running git status:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config <span style="color:#f92672">[</span>--global<span style="color:#f92672">]</span>  status.showUntrackedFiles no
</span></span></code></pre></div><p>Create a handy dandy &ldquo;git graph&rdquo; command (<code>git g</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config --global --add alias.g <span style="color:#e6db74">&#34;log --graph --abbrev-commit --decorate --format=format:&#39;%C(bold blue)%h%C(reset) %
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">C(auto)%d%C(reset) %s %C(dim white)- %an (%ar)&#39; --all&#34;</span>
</span></span></code></pre></div><h2 id="creating-a-new-repo">Creating a new repo<a hidden class="anchor" aria-hidden="true" href="#creating-a-new-repo">#</a></h2>
<ul>
<li>Create a .git directory in the current repository:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git init <span style="color:#f92672">[</span>directory<span style="color:#f92672">]</span>
</span></span></code></pre></div><ul>
<li>Create a bare repository in a file, suitable for external use. By convention,
bare directories always end up in .git. Bare repositories don&rsquo;t have a
working directory, so it&rsquo;s impossible to commit changes to them. All central
repositories should be created with the <code>--bare</code> command line option.  More
detailed explanation: <a href="https://mijingo.com/blog/what-is-a-bare-git-repository">https://mijingo.com/blog/what-is-a-bare-git-repository</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git init --bare &lt;directory.git&gt;
</span></span></code></pre></div><h2 id="branching--merging">Branching &amp; Merging<a hidden class="anchor" aria-hidden="true" href="#branching--merging">#</a></h2>
<ul>
<li>Switch to branch <em>branch</em>: <code>git checkout &lt;branch&gt;</code></li>
<li>Create a branch named <em>branch</em>, optionally at [commit_number]: <code>git checkout -b &lt;branch&gt; [commit_number]</code></li>
<li>Create a branch named <em>branch</em> tracking <em>remote branch</em>: <code>git checkout -b &lt;branch&gt; &lt;remote branch&gt;</code>
<ul>
<li>E.g.: <code>git checkout -b foo origin devel</code></li>
</ul>
</li>
<li>List branches: <code>git branch</code></li>
<li>List all branches (including remote): <code>git branch -a</code></li>
<li>List remote branches: <code>git branch -r</code></li>
<li>Remove remote tracking branch: <code>git branch -r -d &lt;branch&gt;</code></li>
<li>Delete branch <em>remote/branch</em>: <code>git push &lt;remote&gt; --delete &lt;branch&gt;</code>
<ul>
<li>E.g.: <code>git push origin --delete foobar</code></li>
</ul>
</li>
<li>List details about branches: <code>git branch -v</code></li>
<li>Remove branch locally: <code>git branch -d &lt;branch&gt;</code></li>
<li>Remove remote branch: <code>git push &lt;remote&gt; --delete &lt;branch&gt;</code></li>
<li>Create a local branch <em>branch</em> pointing to the current HEAD, but don&rsquo;t switch to it.: <code>git branch &lt;branch&gt;</code></li>
<li>Create a local branch <em>branch</em> pointing to origin/dev: <code>git branch &lt;branch&gt; --track origin/dev</code></li>
<li>The the tracking branch of <em>branch</em> to origin/foo. Set tracking repo of current branch if [branch] is ommitted.: <code>git branch --set-upstream-to=origin/foo [branch]</code></li>
<li>Merge change: <code>git merge &lt;branch&gt;</code>
<ul>
<li>git mergetool:  <a href="https://gist.github.com/karenyyng/f19ff75c60f18b4b8149">https://gist.github.com/karenyyng/f19ff75c60f18b4b8149</a></li>
</ul>
</li>
</ul>
<h3 id="checking-out-a-remote-repo-into-a-local-branch-patching-a-pr-manual-merge">Checking out a remote repo into a local branch (Patching a PR, manual merge)<a hidden class="anchor" aria-hidden="true" href="#checking-out-a-remote-repo-into-a-local-branch-patching-a-pr-manual-merge">#</a></h3>
<p>Create a new branch and pull the remote repo into it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout -b &lt;remote-branch-name&gt; master
</span></span><span style="display:flex;"><span>git pull https://github.com/&lt;user&gt;/&lt;repo&gt; &lt;remote-branch-name&gt;
</span></span></code></pre></div><p>Merge the changes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout master
</span></span><span style="display:flex;"><span>git merge --no-ff &lt;remote-branch-name&gt;   <span style="color:#75715e"># Use --ff-only or rebase if preferred.</span>
</span></span><span style="display:flex;"><span>git push origin master
</span></span></code></pre></div><h2 id="pushing-changes">Pushing Changes<a hidden class="anchor" aria-hidden="true" href="#pushing-changes">#</a></h2>
<ul>
<li>Push current branch to remote branch origin/branchname (creates remote branch if necessary).: <code>git push origin branchname</code></li>
<li>Promote current development branch to master on origin.: <code>git push origin origin/development:master</code></li>
</ul>
<h2 id="diffs-logs--status">Diffs, logs &amp; status<a hidden class="anchor" aria-hidden="true" href="#diffs-logs--status">#</a></h2>
<ul>
<li>Perform manual changes after a git merge, if needed.: <code>git mergetool -t vimdiff</code></li>
<li>Simple one line format log: <code>git log --oneline</code></li>
<li>Diff the current HEAD with the previous version: <code>git diff HEAD^ HEAD</code></li>
<li>Diff a given remote/branch with HEAD.: <code>git diff &lt;remote&gt;/&lt;branch&gt; HEAD</code></li>
<li>Diff index with HEAD.: <code>git diff --cached</code></li>
<li>See all delete operations affecting &ldquo;filename&rdquo;: <code>git log --diff-filter=D -- filename</code>
<ul>
<li>To restore the file: <code>git checkout -r &lt;commit#&gt;~1 -- filename&quot;</code></li>
</ul>
</li>
</ul>
<h2 id="tagging">Tagging<a hidden class="anchor" aria-hidden="true" href="#tagging">#</a></h2>
<ul>
<li>Show all tags (same as git tag -l): <code>git tag</code></li>
<li>Create a lightweight tag named foo: <code>git tag foo</code></li>
<li>Create a regular tag named foo, with the specified message.: <code>git tag -a foo -m &quot;This is the tag foo&quot;</code></li>
<li>Create a tag named foo, at commit 9fceb02: <code>git tag -a foo 9fceb02</code></li>
<li>Push tag foobar to origin.: <code>git push origin foobar</code></li>
<li>Push all tags to origin: <code>git push origin --tags</code></li>
<li>Checks out the repo at the tag version (will create a detached head, create a new branch from this head to work on this tag.): <code>git checkout supertag_foo</code></li>
<li>Delete local tag: <code>git tag -d tagname</code></li>
<li>Delete remote tag: <code>git push --delete origin tagname</code></li>
<li>Push a single tag: <code>git push origin :refs/tags/&lt;tagname&gt;</code></li>
<li>Attach a tag to a commit id: <code>git tag &lt;tagname&gt; &lt;commitId&gt;</code></li>
<li>Delete local and remote tag, retag a given tag at a commit id.: <code>git push origin &lt;tagname&gt;</code></li>
</ul>
<p><strong>Important Note</strong>: Tags won&rsquo;t be pushed without the explicit tag name or the &ndash;tags flag.</p>
<h2 id="submodules">Submodules<a hidden class="anchor" aria-hidden="true" href="#submodules">#</a></h2>
<ul>
<li>Add a submodule to the system (file .gitmodules created): <code>git submodule add &lt;submodule_repo_url&gt;</code></li>
<li>Initialize submodules &ndash; copies submodule name and urls from .gitmodules to .git/config.: <code>git submodule init</code></li>
<li>Clone a module with submodules: <code>git clone --recursive</code></li>
<li>Recursively update submodules. Specify <code>--init</code> to init and update in one step.: <code>git submodule update --recursive [--init]</code></li>
<li>Update the submodule itself to the newest commit from the submodule&rsquo;s upstream. Using git status on the project directory after that will show &ldquo;modified: <em>subproject_name</em> (new commits)&rdquo;. A regular git add/commit should follow.: <code>cd submodule_dir; git pull; cd project_dir</code></li>
<li>Revert submodule state to the submitted one.: <code>git submodule update --init</code></li>
<li>Remove a submodule:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  git submodule deinit &lt;path_to_submodule&gt;
</span></span><span style="display:flex;"><span>  git rm &lt;path_to_submodule&gt;
</span></span><span style="display:flex;"><span>  git commit -m <span style="color:#e6db74">&#34;Removed submodule.&#34;</span>
</span></span><span style="display:flex;"><span>  rm -rf .git/modules/&lt;path_to_submodule&gt;
</span></span></code></pre></div><h2 id="commiting-resetting--rebasing">Commiting, resetting &amp; rebasing<a hidden class="anchor" aria-hidden="true" href="#commiting-resetting--rebasing">#</a></h2>
<ul>
<li>Commit staged files.: <code>git commit</code></li>
<li>Commit all changed files.: <code>git commit -a</code></li>
<li>Verbose. Show a diff during commit message edit.: <code>git commit -v</code></li>
<li>Fix the last commit message.: <code>git commit --amend</code></li>
<li>Squashes the last four commits into one, interactively. After this command, use git push &ndash;force if one of the rebased changes was already pushed. An interactive editor will open to decide what to do with each commit. Changing pick to squash means this commit will be merged with the commit <em>above</em> it (note that git lists the commit in chronological order, so the earlier commits are at the top of the list.): <code>git rebase -i HEAD~4</code></li>
</ul>
<p><strong>Note</strong>: The number after head (n) means N commits will be affected. Just
removing the commit from the list of commits later means it will be discarded!
It&rsquo;s also possible to give a commit#. In this case, all commits from that point
will be included.</p>
<p>Use &ldquo;drop&rdquo; to drop an unwanted commit. Use the &ldquo;&ndash;onto branch&rdquo; keyword to do
all the interactive rebase changes and then rebase on top of another commit in
one operation.</p>
<p>E.g.: Remove one of he commits and rebase on top of upstream/master</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#  Mark the commit to be removed as &#34;drop&#34;</span>
</span></span><span style="display:flex;"><span>git rebase -i HEAD~4 --onto upstream/master
</span></span></code></pre></div><ul>
<li>Resets the repo to commit#: <code>git reset --hard &lt;commit#&gt;</code></li>
<li>Undo the last commit. Leave changes as changed files, ready for editing and a new commit.: <code>git reset HEAD~</code></li>
<li>Same as above, but leaves files staged.: <code>git reset --soft HEAD~</code></li>
<li>Reset a particular file to HEAD. Useful to remove files from the staged area or when unwinding files from a previous git reset &ndash;soft (removing unwanted changes.): <code>git reset HEAD /path/to/unwanted/file</code></li>
</ul>
<h2 id="miscellaneous">Miscellaneous<a hidden class="anchor" aria-hidden="true" href="#miscellaneous">#</a></h2>
<ul>
<li>Show all remotes: <code>git remote -v</code></li>
<li>Show one particular remote. E.g.: git remote show origin: <code>git remote show &lt;remote&gt;</code></li>
<li>Set remote URL (use &ndash;push for push URL) to a given url.: <code>git remote set-url [--push] &lt;remote&gt; &lt;url&gt;</code>
<ul>
<li>E.g.: <code>git remote set-url --push origin git@github.com:foouser/reponame.git</code></li>
</ul>
</li>
<li>Show all files in repo: <code>git ls-files</code></li>
<li>Show reflog (updates to the tip of branches) information. It&rsquo;s possible to undo steps by using &ldquo;git reset&rdquo; on one of the HEADs presented.: <code>git reflog</code></li>
<li>Cherry Picking:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git show remote --oneline
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aaaaaa foo change HEAD
</span></span><span style="display:flex;"><span>bbbbbb bar change
</span></span><span style="display:flex;"><span>cccccc meh change
</span></span></code></pre></div><p>We want to remove bbbbbb:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git reset cccccc --hard
</span></span><span style="display:flex;"><span>git cherrypick -n aaaaaa
</span></span><span style="display:flex;"><span>git status
</span></span></code></pre></div><p>Commit and push as usual.</p>
<h2 id="fully-encrypted-repos-using-git-remote-gcrypt">Fully encrypted repos using git-remote-gcrypt.<a hidden class="anchor" aria-hidden="true" href="#fully-encrypted-repos-using-git-remote-gcrypt">#</a></h2>
<p>Reference: <a href="https://embeddedartistry.com/blog/2018/03/15/safely-storing-secrets-in-git/">https://embeddedartistry.com/blog/2018/03/15/safely-storing-secrets-in-git/</a></p>
<ul>
<li>Install git-remote-gcrypt with <code>apt-get install git-remote-gcrypt</code>.</li>
<li>Important: Must have <code>GPG_TTY</code> set correctly with <code>export GPG_TTY=$(tty)</code>, or
pinentry will barf.</li>
<li>Sample usage:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git remote add origin gcrypt::git@github.com:user/reponame.git
</span></span><span style="display:flex;"><span>git push origin master
</span></span></code></pre></div><p><strong>Important</strong>: EVERY PUSH has <code>--force</code> implied! Make sure to use git pull first!!!</p>
<p>Note on:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcrypt: Repository not found: git@bitbucket.org:mpaganini/crypto-edgerouter.git
</span></span><span style="display:flex;"><span>gcrypt: ..but repository ID is set. Aborting.
</span></span></code></pre></div><p>This happens when the initial repo push fails. We end up with a push ID but the
repo does not have it. In this case, just remove the gcrypt-id of this repo
with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config --unset remote.origin.gcrypt-id
</span></span></code></pre></div><p>Real life example for /etc:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># git remote -v</span>
</span></span><span style="display:flex;"><span>origin  gcrypt::git@github.com:marcopaganini/crypto.git <span style="color:#f92672">(</span>fetch<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>origin  gcrypt::git@github.com:marcopaganini/crypto.git <span style="color:#f92672">(</span>push<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="partially-or-fully-encrypted-repos-using-git-crypt">Partially (or fully) encrypted repos using git-crypt<a hidden class="anchor" aria-hidden="true" href="#partially-or-fully-encrypted-repos-using-git-crypt">#</a></h2>
<h3 id="creating-a-new-repo-1">Creating a new repo<a hidden class="anchor" aria-hidden="true" href="#creating-a-new-repo-1">#</a></h3>
<p>Reference: <code>man git-crypt</code>.</p>
<p>With this solution, we can have some (or all) files encrypted in the repo. It
has the advantage of not requiring a &ldquo;&ndash;force&rdquo; when pushing and accounting for
times correctly. The downside is that the names of the files remain visible.</p>
<ul>
<li><code>apt-get install git-crypt</code></li>
<li>In the repo, <code>git-crypt init</code></li>
<li>Add the user with <code>git-crypt add-gpg-user gpg_key_id</code>. This will create the
<code>.git-crypt</code> directory with the keys.</li>
<li>Create a <code>.gitattributes</code> file indicating which files will be encrypted. E.g:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file_to_encrypt filter<span style="color:#f92672">=</span>git-crypt diff<span style="color:#f92672">=</span>git-crypt
</span></span><span style="display:flex;"><span>*.key filter<span style="color:#f92672">=</span>git-crypt diff<span style="color:#f92672">=</span>git-crypt
</span></span></code></pre></div><p>To encrypt all files (except .gitattributes, naturally):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>* filter<span style="color:#f92672">=</span>git-crypt diff<span style="color:#f92672">=</span>git-crypt
</span></span><span style="display:flex;"><span>.gitattributes !filter !diff
</span></span></code></pre></div><p>Add and commit this file.</p>
<p>Run a <code>git-crypt status</code> and make sure that the required files are encrypted correctly.'</p>
<p>From this point on, git push will store the files encrypted on the remote.</p>
<p>When using a cloned repo, it&rsquo;s important to use <code>git-crypt unlock</code> first.</p>
<p>IMPORTANT: Files added <em>before</em> <code>git-crypt init</code> remain unencrypted. <code>git-crypt status --fix</code>
can fix the current commit, but not the history.</p>
<h3 id="using-an-existing-repo">Using an existing repo<a hidden class="anchor" aria-hidden="true" href="#using-an-existing-repo">#</a></h3>
<p>Sample commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git@github.com:marcopaganini/crypto.git
</span></span><span style="display:flex;"><span>cd cryptorepo
</span></span><span style="display:flex;"><span>git-crypt unlock
</span></span></code></pre></div><h2 id="using-git-lfs">Using git-LFS<a hidden class="anchor" aria-hidden="true" href="#using-git-lfs">#</a></h2>
<p>Installation is simple:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt-get install git-lfs
</span></span><span style="display:flex;"><span>git lfs install --local --skip-smudge
</span></span></code></pre></div><p><strong>Note</strong>: to initialize a repo, <strong>always</strong> use <code>git lfs install --local --skip-smudge</code>. Using the smudge filter will make everything slower, but
without it, a manual <code>git lfs-pull</code> is required every time we want to update
the git-lfs files.</p>
<ul>
<li>To add files to be tracked: <code>git lfs track glob</code> (E.g.: <code>git lfs track *.ttf</code>)</li>
<li><code>git lfs pull</code> will bring the files.</li>
</ul>
<p>To Uninstall:</p>
<ul>
<li>Remove the files from git-lfs control with <code>git lfs untrack glob</code>. This will remove the
<code>.gitattributes</code> file from the directory where they live.</li>
<li>Commit the changes.</li>
<li>Remove the previously tracked files (with <code>rm</code>, <strong>not</strong> <code>git rm</code>).</li>
<li>Run <code>git checkout .</code>. This will bring the original pointer files. It&rsquo;s also possible to
delete the files with <code>git rm</code> or <code>git rm --cached</code> (if we want to keep the files.)</li>
<li>Use <code>git rm</code> to remove the pointer files.</li>
<li>Run <code>git lfs uninstall --worktree</code> to remove git-lfs from the local repository config.</li>
</ul>
<p><strong>Note</strong>: <code>git-lfs ls-files</code> will show all LFS &ldquo;controlled&rdquo; files until the repo is re-created.</p>
<h2 id="simple-github-workflow">Simple github workflow<a hidden class="anchor" aria-hidden="true" href="#simple-github-workflow">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone git@github.com/marcopaganini/repo &lt;-- checks out the forked repo
</span></span><span style="display:flex;"><span>cd repo
</span></span><span style="display:flex;"><span>git branch -vv <span style="color:#f92672">(</span>shows the branches<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>git checkout -b dev <span style="color:#f92672">(</span>creates a branch dev, without tracking<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Before every change:</p>
<ul>
<li>Update all remotes: <code>git remote update</code></li>
<li>Create a working repo: <code>git checkout -b dev</code></li>
<li>Reset the working repo to upstream: <code>git reset upstream/master --hard</code>
<ul>
<li>Also possible to pull/rebase directly from dev: <code>git pull -r upstream master</code></li>
</ul>
</li>
<li>Do the changes, <code>git add</code>, <code>git commit</code>.</li>
<li>When ready to submit: <code>git pull -r upstream master</code> (making sure we&rsquo;re on top of head).</li>
<li><code>git push origin dev</code></li>
<li>Go to <a href="https://github.com">https://github.com</a> and open a PR (or use <code>gh pr create</code>)</li>
</ul>
<p>In case of changes:</p>
<ul>
<li>Repeat edits, commit, push</li>
<li><code>git pull -r upstream master</code></li>
<li><code>git push origin dev --force</code> (&ndash;force may be needed or not, depending on the situation).</li>
</ul>
<p>It is also possible to use a regular commit instead of rebase, and rebase on
github at merge time. This makes it somewhat easier to have simultaneous
development branches, but creates a non-linear history on the repo.</p>
<h2 id="tip-storing-images-in-github">Tip: Storing images in github<a hidden class="anchor" aria-hidden="true" href="#tip-storing-images-in-github">#</a></h2>
<p>The idea is to create a new branch with no commits (&ndash;orphan) and store the
images here. They can be referenced directly from markdown on the main branch.
In a nutshell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout --orphan assets  <span style="color:#75715e"># Start a new branch from nothing.</span>
</span></span><span style="display:flex;"><span>git rm -rf .                  <span style="color:#75715e"># Remove everything from this branch.</span>
</span></span><span style="display:flex;"><span>&lt;copy image in&gt;
</span></span><span style="display:flex;"><span>git add; git commit
</span></span><span style="display:flex;"><span>git push origin assets
</span></span><span style="display:flex;"><span>git checkout master
</span></span></code></pre></div><p>To refer to this file, use (in the master branch): <code>![Image](../assets/file.png?raw=true)</code></p>
<ul>
<li>Source: <a href="https://gist.github.com/joncardasis/e6494afd538a400722545163eb2e1fa5">https://gist.github.com/joncardasis/e6494afd538a400722545163eb2e1fa5</a></li>
</ul>
<h2 id="daisy-chained-changes-using-github">Daisy Chained changes using github<a hidden class="anchor" aria-hidden="true" href="#daisy-chained-changes-using-github">#</a></h2>
<p>Taken from: <a href="https://graysonkoonce.com/stacked-pull-requests-keeping-github-diffs-small/">https://graysonkoonce.com/stacked-pull-requests-keeping-github-diffs-small/</a></p>
<p>The idea is to have multiple pending PRs, one depending on the previous one,
with only the diffs to the previous one. This only works if using branches on
the same repository where the final changes are to be merged. Basic idea:</p>
<h3 id="create-a-branch-named-foo-part1-with-the-first-part-of-our-changes">Create a branch named foo-part1 with the first part of our changes.<a hidden class="anchor" aria-hidden="true" href="#create-a-branch-named-foo-part1-with-the-first-part-of-our-changes">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout -b foo-part1
</span></span><span style="display:flex;"><span>&lt;hack away...&gt;
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#39;Changes, part 1&#39;</span>
</span></span><span style="display:flex;"><span>git push origin foo-part1
</span></span><span style="display:flex;"><span>hub pull-request  <span style="color:#75715e"># This will create a PR from foo-part1 -&gt; master</span>
</span></span></code></pre></div><h3 id="create-a-second-branch-names-foo-part1-with-the-second-part-of-changes">Create a second branch names foo-part1 with the second part of changes.<a hidden class="anchor" aria-hidden="true" href="#create-a-second-branch-names-foo-part1-with-the-second-part-of-changes">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout -b foo-part2
</span></span><span style="display:flex;"><span>&lt;hack away...&gt;
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#39;Changes, part 2&#39;</span>
</span></span><span style="display:flex;"><span>git push origin foo-part2
</span></span><span style="display:flex;"><span>hub pull-request -b foo-part1  <span style="color:#75715e"># Notice how the base is the previous branch!</span>
</span></span></code></pre></div><p>Repeat this as many times as needed.</p>
<p>If a change is required in one of the PRs, don&rsquo;t forget to merge (not rebase)
the change to the upper ones. E.g.: Change on part2 must be merged in part3:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout foo-part2
</span></span><span style="display:flex;"><span>git merge foo-part2
</span></span><span style="display:flex;"><span>git commit...
</span></span><span style="display:flex;"><span>git push origin-part2
</span></span></code></pre></div><p>Once the PRs have been approved, squash/merge them from the top down. The first
one can be rebased into master.</p>
<ol>
<li>squash/merge foo-part2 into foo-part1</li>
<li>squash/rebase foo-part1 into master</li>
</ol>
<p>Remove the branches to keep the repo clean, if that&rsquo;s desirable.  Interesting
discussion on git merge &amp; git rebase
<a href="http://stackoverflow.com/questions/6406762/why-am-i-merging-remote-tracking-branch-origin-develop-into-develop">http://stackoverflow.com/questions/6406762/why-am-i-merging-remote-tracking-branch-origin-develop-into-develop</a></p>
<p>And&hellip;</p>
<p><a href="https://www.derekgourlay.com/blog/git-when-to-merge-vs-when-to-rebase/">https://www.derekgourlay.com/blog/git-when-to-merge-vs-when-to-rebase/</a></p>
<h2 id="workflow-from-repo-creation-to-use">Workflow from repo creation to use:<a hidden class="anchor" aria-hidden="true" href="#workflow-from-repo-creation-to-use">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git init --bare /tmp/foo.git
</span></span><span style="display:flex;"><span>Initialized empty Git repository in /tmp/foo.git/
</span></span><span style="display:flex;"><span>$ mkdir /tmp/client
</span></span><span style="display:flex;"><span>$ cd /tmp/client
</span></span><span style="display:flex;"><span>$ git clone ssh://&lt;host&gt;:/tmp/foo.git .
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#e6db74">&#39;.&#39;</span>...
</span></span><span style="display:flex;"><span>warning: You appear to have cloned an empty repository.
</span></span><span style="display:flex;"><span>Checking connectivity... <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>$ git remote show origin
</span></span><span style="display:flex;"><span>* remote origin
</span></span><span style="display:flex;"><span>  Fetch URL: ssh://localhost:/tmp/foo.git
</span></span><span style="display:flex;"><span>  Push  URL: ssh://localhost:/tmp/foo.git
</span></span><span style="display:flex;"><span>  HEAD branch: <span style="color:#f92672">(</span>unknown<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Local branch configured <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;git pull&#39;</span>:
</span></span><span style="display:flex;"><span>    master merges with remote master
</span></span><span style="display:flex;"><span>$ echo haha &gt;README
</span></span><span style="display:flex;"><span>$ git add README
</span></span><span style="display:flex;"><span>$ git status
</span></span><span style="display:flex;"><span>On branch master
</span></span><span style="display:flex;"><span>Initial commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Changes to be committed:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#34;git rm --cached &lt;file&gt;...&#34;</span> to unstage<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        new file:   README
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Untracked files not listed <span style="color:#f92672">(</span>use -u option to show untracked files<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>$ git commit -m <span style="color:#e6db74">&#34;Initial import.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>master <span style="color:#f92672">(</span>root-commit<span style="color:#f92672">)</span> 18fb1b9<span style="color:#f92672">]</span> Initial import.
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">1</span> file changed, <span style="color:#ae81ff">1</span> insertion<span style="color:#f92672">(</span>+<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> create mode <span style="color:#ae81ff">100644</span> README
</span></span><span style="display:flex;"><span>$ git push origin master
</span></span><span style="display:flex;"><span>Counting objects: 3, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Writing objects: 100% <span style="color:#f92672">(</span>3/3<span style="color:#f92672">)</span>, <span style="color:#ae81ff">217</span> bytes | <span style="color:#ae81ff">0</span> bytes/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Total <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>To ssh://localhost:/tmp/foo.git
</span></span><span style="display:flex;"><span> * <span style="color:#f92672">[</span>new branch<span style="color:#f92672">]</span>      master -&gt; master
</span></span><span style="display:flex;"><span>$ git branch -a
</span></span><span style="display:flex;"><span>* master
</span></span><span style="display:flex;"><span>  remotes/origin/master
</span></span></code></pre></div><h2 id="changing-author-info-on-an-existing-repo">Changing author info on an existing repo<a hidden class="anchor" aria-hidden="true" href="#changing-author-info-on-an-existing-repo">#</a></h2>
<p><a href="https://help.github.com/articles/changing-author-info/">https://help.github.com/articles/changing-author-info/</a></p>
<h2 id="removing-all-history-for-deleted-files">Removing all history for deleted files<a hidden class="anchor" aria-hidden="true" href="#removing-all-history-for-deleted-files">#</a></h2>
<p>This answer seems to be the best:</p>
<ul>
<li><a href="http://stackoverflow.com/questions/17901588/new-repo-with-copied-history-of-only-currently-tracked-files/17909526#17909526">http://stackoverflow.com/questions/17901588/new-repo-with-copied-history-of-only-currently-tracked-files/17909526#17909526</a></li>
</ul>
<h2 id="delete-everything-and-restore-what-you-want">Delete everything and restore what you want<a hidden class="anchor" aria-hidden="true" href="#delete-everything-and-restore-what-you-want">#</a></h2>
<p>Rather than delete this-list-of-files one at a time, do the almost-opposite,
delete everything and just restore the files you want to keep:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout master
</span></span><span style="display:flex;"><span>git ls-files &gt; keep-these.txt
</span></span><span style="display:flex;"><span>git filter-branch --force --index-filter <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;git rm --ignore-unmatch --cached -qr . ; cat </span>$PWD<span style="color:#e6db74">/keep-these.txt | xargs git reset -q \$GIT_COMMIT --&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --prune-empty --tag-name-filter cat -- --all
</span></span></code></pre></div><h3 id="cleanup-steps">Cleanup steps<a hidden class="anchor" aria-hidden="true" href="#cleanup-steps">#</a></h3>
<p>Once the whole process has finished, then cleanup:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm -rf .git/refs/original/
</span></span><span style="display:flex;"><span>git reflog expire --expire<span style="color:#f92672">=</span>now --all
</span></span><span style="display:flex;"><span>git gc --prune<span style="color:#f92672">=</span>now
</span></span><span style="display:flex;"><span><span style="color:#75715e"># optional extra gc. Slow and may not further-reduce the repo size</span>
</span></span><span style="display:flex;"><span>git gc --aggressive --prune<span style="color:#f92672">=</span>now
</span></span></code></pre></div><h2 id="removing-a-large-file-from-the-repository">Removing a large file from the repository<a hidden class="anchor" aria-hidden="true" href="#removing-a-large-file-from-the-repository">#</a></h2>
<p><a href="http://goo.gl/J9aOP">http://goo.gl/J9aOP</a></p>
<p>Comparing the repository size before and after, should indicate a sizable
reduction, and of course only commits that touch the kept files, plus merge
commits - even if empty (because that&rsquo;s how &ndash;prune-empty works), will be in
the history.</p>
<p>Copying one directory to another repo, keeping history:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone foo
</span></span><span style="display:flex;"><span>cd foo
</span></span><span style="display:flex;"><span>git filter-branch --subdirectory-filter directory_to_keep -- --all
</span></span><span style="display:flex;"><span>git remote -v
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (confirm old origin, then...)</span>
</span></span><span style="display:flex;"><span>git remote set-url origin &lt;remote_url_origin.git&gt;
</span></span><span style="display:flex;"><span>git remote -v
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (make sure all is fine, then...)</span>
</span></span><span style="display:flex;"><span>git push origin
</span></span></code></pre></div><p>Another solution from: <a href="http://goo.gl/VsMAc">http://goo.gl/VsMAc</a></p>
<p>Make a copy of repository A so you can mess with it without worrying about
mistakes too much.  It’s also a good idea to delete the link to the original
repository to avoid accidentally making any remote changes (line 3).  Line 4 is
the critical step here.  It goes through your history and files, removing
anything that is not in directory 1.  The result is the contents of directory 1
spewed out into to the base of repository A.  You probably want to import these
files into repository B within a directory, so move them into one now (lines
5/6). Commit your changes and we’re ready to merge these files into the new
repository.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone &lt;git repository A url&gt;
</span></span><span style="display:flex;"><span>cd &lt;git repository A directory&gt;
</span></span><span style="display:flex;"><span>git remote rm origin
</span></span><span style="display:flex;"><span>git filter-branch --subdirectory-filter &lt;directory 1&gt; -- --all
</span></span><span style="display:flex;"><span>mkdir &lt;directory 1&gt;
</span></span><span style="display:flex;"><span>mv * &lt;directory 1&gt;
</span></span><span style="display:flex;"><span>git add .
</span></span><span style="display:flex;"><span>git commit
</span></span></code></pre></div><p>Make a copy of repository B if you don’t have one already.  On line 3, you’ll
create a remote connection to repository A as a branch in repository B.  Then
simply pull from this branch (containing only the directory you want to move)
into repository B.  The pull copies both files and history.  Note: You can use
a merge instead of a pull, but pull worked better for me. Finally, you probably
want to clean up a bit by removing the remote connection to repository A.
Commit and you’re all set.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone &lt;git repository B url&gt;
</span></span><span style="display:flex;"><span>cd &lt;git repository B directory&gt;
</span></span><span style="display:flex;"><span>git remote add repo-A-branch &lt;git repository A directory&gt;
</span></span><span style="display:flex;"><span>git pull repo-A-branch master
</span></span><span style="display:flex;"><span>git remote rm repo-A-branch
</span></span></code></pre></div><h2 id="cleaning-upsplitting-repo">Cleaning up/splitting repo<a hidden class="anchor" aria-hidden="true" href="#cleaning-upsplitting-repo">#</a></h2>
<p>THE SOLUTION WHAT WORKED:</p>
<p>Get BFG @ <a href="http://rtyley.github.io/bfg-repo-cleaner/">http://rtyley.github.io/bfg-repo-cleaner/</a></p>
<p>Many options, but I stripped by directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone --mirror ssh://triton:/data/git/all.git .
</span></span><span style="display:flex;"><span>java -jar bfg.jar --delete-folders mods .
</span></span><span style="display:flex;"><span>git reflog expire --expire<span style="color:#f92672">=</span>now --all
</span></span><span style="display:flex;"><span>git gc --prune<span style="color:#f92672">=</span>now --aggressive
</span></span></code></pre></div><p>Comparing the results:</p>
<p>On each directory, generate a list of revs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git rev-list --objects --all | awk <span style="color:#e6db74">&#39;(NF &gt; 1) { print $2 }&#39;</span> | sort -u &gt;fileX
</span></span></code></pre></div><p>Then diff files.</p>
<h2 id="repo-size-in-kb">Repo size in KB<a hidden class="anchor" aria-hidden="true" href="#repo-size-in-kb">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git count-objects -v | grep size-pack
</span></span></code></pre></div><h2 id="links--useful-sites">Links &amp; Useful sites<a hidden class="anchor" aria-hidden="true" href="#links--useful-sites">#</a></h2>
<ul>
<li>Git maintenance &amp; data recovery:
<a href="http://git-scm.com/book/en/Git-Internals-Maintenance-and-Data-Recovery">http://git-scm.com/book/en/Git-Internals-Maintenance-and-Data-Recovery</a></li>
<li>Git for SVN users: <a href="http://git.or.cz/course/svn.html">http://git.or.cz/course/svn.html</a></li>
<li><a href="https://learngitbranching.js.org/">https://learngitbranching.js.org/</a>
<ul>
<li>&ldquo;the most visual and interactive way to learn Git on the web; you&rsquo;ll be
challenged with exciting levels, given step-by-step demonstrations of
powerful features, and maybe even have a bit of fun along the way.&rdquo;</li>
</ul>
</li>
<li><a href="https://kbroman.org/github_tutorial/">https://kbroman.org/github_tutorial/</a>
<ul>
<li>&ldquo;git/github guide a minimal tutorial&rdquo;</li>
</ul>
</li>
<li><a href="http://think-like-a-git.net/">http://think-like-a-git.net/</a>
<ul>
<li>&ldquo;My goal with this site is to help you, Dear Reader, understand what those
smug bastards [git knowers] are talking about.&rdquo;
<ul>
<li>Looks especially useful: <a href="http://think-like-a-git.net/halp.html">http://think-like-a-git.net/halp.html</a>, &ldquo;If
you&rsquo;ve just lost some work in Git, and you&rsquo;re trying to recover your lost
commits, this page is for you.&rdquo;</li>
</ul>
</li>
</ul>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.paganini.net/tags/coding/">Coding</a></li>
      <li><a href="https://www.paganini.net/tags/git/">Git</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.paganini.net/posts/bash/">
    <span class="title">« Prev</span>
    <br>
    <span>Some slightly obscure bash notes.</span>
  </a>
  <a class="next" href="https://www.paganini.net/posts/resume/">
    <span class="title">Next »</span>
    <br>
    <span>Marco Paganini - Resume</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on x"
            href="https://x.com/intent/tweet/?text=Git%20Tips&amp;url=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f&amp;hashtags=coding%2cgit">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f&amp;title=Git%20Tips&amp;summary=Git%20Tips&amp;source=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f&title=Git%20Tips">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on whatsapp"
            href="https://api.whatsapp.com/send?text=Git%20Tips%20-%20https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on telegram"
            href="https://telegram.me/share/url?text=Git%20Tips&amp;url=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Git Tips on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Git%20Tips&u=https%3a%2f%2fwww.paganini.net%2fposts%2fgit%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© paganini.net</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
